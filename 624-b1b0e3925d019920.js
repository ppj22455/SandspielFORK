"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[624],{2624:function(e,t,n){n.r(t),n.d(t,{default:function(){return _e}});var i=n(4051),r=n.n(i),o=n(5893),s=n(7294),l=n(8767),a=n(7650),u=n(3658),p=n(3299),c=(n(1664),n(7743),n(4873)),d=n(1163),h=n(9669),m=n.n(h),f=n(8256),y=(n(5466),n(4093)),I=n(3580),g=n.n(I),v=n(619),b=n(2395),E=n(8824);function x(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var j=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.fps=document.getElementById("fps"),this.frames=[],this.times=[],this.lastFrameTimeStamp=performance.now()}var t,n;return t=e,(n=[{key:"render",value:function(e){this.fps||(this.fps=document.getElementById("fps"),this.frames=[],this.times=[],this.lastFrameTimeStamp=performance.now());var t=performance.now(),n=t-this.lastFrameTimeStamp;this.lastFrameTimeStamp=t;var i=1/n*1e3;this.frames.push(i),this.frames.length>30&&this.frames.shift();for(var r=1/0,o=-1/0,s=0,l=0;l<this.frames.length;l++)s+=this.frames[l],r=Math.min(this.frames[l],r),o=Math.max(this.frames[l],o);var a=s/this.frames.length;this.fps&&(this.fps.textContent="".concat(Math.round(a),"fps"))}}])&&x(t.prototype,n),e}()),N=n(9547),A=n.n(N),C=n(4184),T=n.n(C);function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function L(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o=[],s=!0,l=!1;try{for(n=n.call(e);!(s=(i=n.next()).done)&&(o.push(i.value),!t||o.length!==t);s=!0);}catch(e){l=!0,r=e}finally{try{s||null==n.return||n.return()}finally{if(l)throw r}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?w(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var M=function(e){var t=e.i,n=e.elements,i=e.colors,r=e.color2s,s=e.setSelected,l=e.selected,a=e.shrink,u=e.inert,p=i[t],c=r[t],d=L(null!=p?p:[0,.5,.5],3),h=d[0],m=d[1],f=d[2],y=L(null!=c?c:[0,.5,.5],3),I=y[0],g=y[1],b=y[2],E="hsla(".concat(360*h,",").concat(100*m,"%,").concat(100*f,"%,0.5)"),x="hsla(".concat(360*I,",").concat(100*g,"%,").concat(100*b,"%,0.5)"),j=L((0,v.Z)("/media/disconnect.wav",{playbackRate:.2+t/15,volume:.15}),1)[0],N="linear-gradient(45deg,\n    ".concat(E,", \n    ").concat(x,"    \n    )");return(0,o.jsx)("button",{className:T()("simulation-button",{selected:l,shrink:a}),onClick:function(){s&&(j(),document.querySelector(".blocklyMainBackground").style.fill=N,E.replace("0.5","0.3"),s(t))},style:{pointerEvents:u&&"none",background:N},children:n[t]})},S=function(e){var t=e.selectedElement,n=e.setSelected,i=e.colors,r=e.color2s,l=e.elements,a=e.disabled,u=e.inert,p=void 0!==u&&u,c=l.filter((function(e,t){return!a[t]})),d=(0,s.useState)(null),h=d[0],m=d[1],f=L((0,v.Z)("/media/disconnect.wav",{volume:.25}),1)[0];return(0,o.jsxs)("div",{className:"jsx-b3e1b6a7c9b96113 element-tray",children:[l.map((function(e,s){return a[s]?null:(0,o.jsx)(M,{elements:l,colors:i,color2s:r,i:s,setSelected:n,selected:s===t,inert:p,shrink:"-"===h&&s===t},s)})),!1===p&&(0,o.jsxs)("span",{onMouseLeave:function(){return m(null)},className:"jsx-b3e1b6a7c9b96113",children:[(0,o.jsx)("button",{onMouseEnter:function(){return m("-")},onClick:function(){f(),E.oR.getState().deleteSelectedElement()},className:"jsx-b3e1b6a7c9b96113 simulation-button element-control",children:"-"}),c.length<E.O4&&(0,o.jsx)("button",{onMouseEnter:function(){return m("+")},onClick:function(){f(),E.oR.getState().newElement()},className:"jsx-b3e1b6a7c9b96113 simulation-button element-control ",children:"+"})]}),!p&&(0,o.jsx)("div",{className:"jsx-b3e1b6a7c9b96113 spacer"}),(0,o.jsx)(A(),{id:"b3e1b6a7c9b96113",children:""})]})},k=function(e){var t=e.selectedElement,n=e.setSelected,i=(0,E.oR)((function(e){return e.elements})),r=(0,E.oR)((function(e){return e.disabled})),s=(0,E.oR)((function(e){return e.colors})),l=(0,E.oR)((function(e){return e.color2s}));return(0,o.jsx)(S,{elements:i,disabled:r,colors:s,color2s:l,selectedElement:t,setSelected:n})},_=n(7e3),D=n(8371);var O=n(1896);function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function B(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o=[],s=!0,l=!1;try{for(n=n.call(e);!(s=(i=n.next()).done)&&(o.push(i.value),!t||o.length!==t);s=!0);}catch(e){l=!0,r=e}finally{try{s||null==n.return||n.return()}finally{if(l)throw r}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return F(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?F(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}E.n2.updaters=E.ZP.getState().elements.map((function(){return function(){}.bind(E.n2)}));var U=null,R=[0,0],V=0,P=function(){var e=B((0,c.Kx)({edit:(0,c.Wc)(c.dJ,!1)}),2),t=e[0],n=e[1],i=!t.edit,r=700,l=!1,a=function(){r=Math.min(window.innerWidth/2,.6*window.innerHeight),l=!1,window.innerWidth<=700&&(r=window.innerWidth-6,l=!0)};a();var u=B((0,v.Z)("/media/clave1.wav",{volume:.15}),1)[0],p=B((0,v.Z)("/media/clave1.wav",{volume:.05}),1)[0],d=(0,E.ZP)((function(e){return e.selectedElement})),h=(0,E.ZP)((function(e){return e.updateScheme})),m=(0,E.ZP)((function(e){return e.taggedMode})),f=(0,E.ZP)((function(e){return e.setSelected})),y=(0,E.ZP)((function(e){return e.setUpdateScheme})),I=(0,E.ZP)((function(e){return e.setTaggedMode}));new URLSearchParams(window.location.search).has("bench")&&(E.n2.updateScheme="BENCHMARK");var x=s.useRef(),N=s.useRef(),A=(0,s.useState)(!1),C=A[0],T=A[1];s.useEffect((function(){N.current=(0,b.e8)({canvas:x.current,width:D.bf,height:D.Cb,sands:D.KT}).render})),(0,s.useEffect)((function(){E.n2.updateScheme=h,E.n2.taggedMode=m}),[d,h,m]),g()((function(e){if(E.ZP.getState().paused)null==N||N.current();else{var t=performance.now();(0,D.Ky)(N),null==N||N.current();var n=performance.now()-t;j.render(n)}}),[]);var w=(0,s.useState)(r),L=w[0],M=w[1],S=(0,s.useState)(!1),F=S[0],P=S[1],H=(0,s.useCallback)((function(e){e.preventDefault();var t=window.innerWidth-e.pageX;M(t)}),[]),W=(0,s.useCallback)((function(e){P(!1),clearInterval(U),T(!1)}),[P]);(0,s.useEffect)((function(){return F&&window.addEventListener("mousemove",H),window.addEventListener("mouseup",W),function(){window.removeEventListener("mousemove",H),window.removeEventListener("mouseup",W)}}),[F]),(0,s.useEffect)((function(){return window.addEventListener("resize",(function(){a(),M(r)})),function(){window.removeEventListener("resize",a)}}));var z=(0,s.useCallback)((function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=x.current.getBoundingClientRect(),i=E.ZP.getState(),r=i.worldWidth,o=i.worldHeight,s=(n.width-6)/r,l=(n.height-6)/o,a=Math.floor((e.clientX-3-n.left)/s),u=Math.floor((e.clientY-3-n.top)/l),c=E.ZP.getState(),h=c.size;if((0,c.setPos)([a,u]),C||t){var m=function(e,t,n,i,r){for(var o,s,l,a,u=(o=e,s=t,l=n,a=i,Math.sqrt(Math.pow(o-l,2)+Math.pow(s-a,2))/r),p=[],c=0;c<=1;c+=1/u){var d={x:e*c+n*(1-c),y:t*c+i*(1-c)};p.push(d)}return p}(R[0],R[1],a,u,1);E.n2.tNoise+=.05,m.forEach((function(e,n){var i=e.x,r=e.y;0!=n||V%4!=0&&!t||p({playbackRate:(.7+d/10+.5*Math.sin((i+r)/10))/((h+5)/5)});for(var o=h/2,s=-o;s<=o;s+=1)for(var l=-o;l<=o;l+=1)s*s+l*l>o*o||(0,D.aJ)([Math.floor(i+s),Math.floor(r+l)],d,[4*s,4*l])})),V++,R=[a,u],clearInterval(U),U=setInterval((function(){z(e,!0)}),60)}}),[C,d]);return(0,o.jsxs)("div",{id:"world",style:{width:i?r:L},children:[(0,o.jsx)(O.default,{}),(0,o.jsx)("div",{className:"resizeHandle",style:{display:i?"none":""},onMouseDown:function(){P(!0)}}),(0,o.jsx)("button",{className:"editor-toggle",style:{position:"absolute",left:-8,zIndex:9e3,transform:"translateX(-100%)"},onClick:function(e){u(),n({edit:i?1:void 0})},children:i?"<-  Open Editor ":"-> Close Editor"}),(0,o.jsx)(k,{selectedElement:d,setSelected:f}),(0,o.jsx)("canvas",{id:"worldCanvas",onMouseDown:function(e){var t=x.current.getBoundingClientRect(),n=E.ZP.getState(),i=n.worldWidth,r=n.worldHeight,o=(t.width-6)/i,s=(t.height-6)/r,l=Math.floor((e.clientX-3-t.left)/o),a=Math.floor((e.clientY-3-t.top)/s);R=[l,a],(0,D.IQ)(),T(!0),clearInterval(U),U=setInterval((function(){z(e,!0)}),60),z(e,!0)},onMouseOut:function(){clearInterval(U),(0,E.ZP.getState().setPos)([-1,-1])},onMouseMove:z,onTouchStart:function(e){var t=Array.from(e.touches);if(!(t.length<1)){var n=t[0],i=x.current.getBoundingClientRect(),r=E.ZP.getState(),o=r.worldWidth,s=r.worldHeight,l=(i.width-6)/o,a=(i.height-6)/s,u=Math.floor((e.clientX-3-i.left)/l),p=Math.floor((e.clientY-3-i.top)/a);(0,D.IQ)(),clearInterval(U),e.clientX=n.clientX,e.clientY=n.clientY,U=setInterval((function(){z(e,!0)}),60),R=[u,p]}},onTouchEnd:function(){clearInterval(U)},onTouchMove:function(e){var t=Array.from(e.touches);if(1===t.length){e.preventDefault();var n=t[0];e.clientX=n.clientX,e.clientY=n.clientY,T(!0),z(e),clearInterval(U),U=setInterval((function(){z(e,!0)}),60)}},ref:x,height:4*D.Cb,width:4*D.bf}),(0,o.jsx)(_.Z,{playMode:i,updateScheme:h,setUpdateScheme:y,taggedMode:m,setTaggedMode:I}),!i&&l&&(0,o.jsx)("h2",{children:"   To edit elements, use a bigger screen!"})]})};P.propTypes={};var H=P,W=n(3493),z=n.n(W),Z=n(4948),G=n.n(Z),J=n(8781),Y=(n(3852),n(9177)),X=n.n(Y);function Q(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function K(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function q(e){return(q=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function $(e,t){return($=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var ee=function(e){return e&&"undefined"!=typeof Symbol&&e.constructor===Symbol?"symbol":typeof e};function te(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,i=q(e);if(t){var r=q(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return function(e,t){return!t||"object"!==ee(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}(this,n)}}G().setLocale(X());var ne=function(e){ne.superClass_.constructor.call(this,e)};G().utils.object.inherits(ne,G().zelos.Renderer),ne.prototype.makeConstants_=function(){return new ie};var ie=function(){ie.superClass_.constructor.call(this),this.FIELD_COLOUR_FULL_BLOCK=!1,this.ADD_START_HATS=!0,this.FIELD_COLOUR_DEFAULT_WIDTH=70,this.FIELD_COLOUR_DEFAULT_HEIGHT=30,this.BOTTOM_ROW_AFTER_STATEMENT_MIN_HEIGHT=12,this.STATEMENT_INPUT_PADDING_LEFT=12,this.FIELD_DROPDOWN_COLOURED_DIV=!0,this.CORNER_RADIUS=4,this.FULL_BLOCK_FIELDS=!0,this.MIN_BLOCK_WIDTH=4,this.MEDIUM_PADDING=8,this.NOTCH_OFFSET_LEFT=12,this.NOTCH_WIDTH=36};G().utils.object.inherits(ie,G().zelos.ConstantProvider),G().blockRendering.unregister("custom_renderer"),G().blockRendering.register("custom_renderer",ne),G().ContextMenuRegistry.registry.getItem("blockCopyToStorage")&&G().ContextMenuRegistry.registry.unregister("blockCopyToStorage"),G().ContextMenuRegistry.registry.getItem("blockPasteFromStorage")&&G().ContextMenuRegistry.registry.unregister("blockPasteFromStorage"),(new J.v).init({contextMenu:!0,shortcut:!0}),G().ContextMenuRegistry.registry.getItem("blockCopyToStorage").weight=2,G().ContextMenuRegistry.registry.getItem("blockPasteFromStorage").weight=3;var re=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&$(e,t)}(r,e);var t,n,i=te(r);function r(e){var t;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,r),(t=i.call(this,e)).blocklyDiv=s.createRef(),t.toolbox=s.createRef(),t}return t=r,n=[{key:"componentDidMount",value:function(){var e=this,t=this.props,n=t.initialXml,i=(t.children,function(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}(t,["initialXml","children"]));this.primaryWorkspace=G().inject(this.blocklyDiv.current,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){K(e,t,n[t])}))}return e}({toolbox:this.toolbox.current},i));var r=function(t){G().svgResize(e.primaryWorkspace)};r=z()(r,32),new ResizeObserver(r).observe(document.querySelector("#blocklyDiv")),n&&G().Xml.domToWorkspace(G().Xml.textToDom(n),this.primaryWorkspace)}},{key:"workspace",get:function(){return this.primaryWorkspace}},{key:"setXml",value:function(e){G().Xml.domToWorkspace(G().Xml.textToDom(e),this.primaryWorkspace)}},{key:"render",value:function(){var e=this.props,t=e.children,n=e.style;return(0,o.jsxs)(s.Fragment,{children:[(0,o.jsx)("div",{ref:this.blocklyDiv,id:"blocklyDiv",style:n}),(0,o.jsx)("xml",{xmlns:"https://developers.google.com/blockly/xml",is:"blockly",style:{display:"none"},ref:this.toolbox,children:t})]})}}],n&&Q(t.prototype,n),r}(s.Component);function oe(e,t){if(null==e)return{};var n,i,r=function(e,t){if(null==e)return{};var n,i,r={},o=Object.keys(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(i=0;i<o.length;i++)n=o[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var se=re,le=function(e){var t=e.children,n=oe(e,["children"]);return n.is="blockly",s.createElement("block",n,t)},ae=function(e){var t=e.children,n=oe(e,["children"]);return n.is="blockly",s.createElement("value",n,t)},ue=function(e){var t=e.children,n=oe(e,["children"]);return n.is="blockly",s.createElement("field",n,t)},pe=function(e){var t=e.children,n=oe(e,["children"]);return n.is="blockly",s.createElement("shadow",n,t)},ce=n(3158),de=n(9425),he=n(397);function me(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}f.Blocks.sand_behavior_base={init:function(){var e=new f.FieldTextInput("Sand",(function(e){if(E.oR.getState().setElementName(E.oR.getState().selectedElement,e.slice(0,20)),void 0!==E.n2.workspace){var t=E.n2.workspace.getAllBlocks(),n=!0,i=!1,r=void 0;try{for(var o,s=t[Symbol.iterator]();!(n=(o=s.next()).done);n=!0){var l=o.value;"element_literal"===l.type&&l.rebuild()}}catch(e){i=!0,r=e}finally{try{n||null==s.return||s.return()}finally{if(i)throw r}}return e.slice(0,20)}}));e.maxDisplayLength=20,this.appendDummyInput().appendField("Name:").appendField(e,"ELEMENT_NAME"),this.appendDummyInput().appendField("Color: ").appendField(new ce.ColorWheelField("#7faaf0",150,{layoutDirection:"vertical"}),"COLOR").appendField("»").appendField(new ce.ColorWheelField("#7fdab4",150,{layoutDirection:"vertical"}),"COLOR2").setAlign(f.ALIGN_RIGHT),this.setNextStatement(!0,null),this.setTooltip("Behavior for the element"),this.setHelpUrl(""),this.setInputsInline(!0),this.setDeletable(!1),this.setMovable(!0),this.setColour(160)}},f.Blocks.number_literal={init:function(){this.appendDummyInput().setAlign(f.ALIGN_CENTRE).appendField(new de.R(0,-100,100,1),"VALUE"),this.setOutput(!0,"Number"),this.setColour(210),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.number_literal_positive={init:function(){var e=new de.R(0,0,100,1);this.appendDummyInput().setAlign(f.ALIGN_CENTRE).appendField(e,"VALUE"),this.setOutput(!0,"Number"),this.setColour(210),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.element_literal={init:function(){f.FieldDropdown.prototype.doClassValidation_=function(e){return e},f.FieldDropdown.prototype.doValueUpdate_=function(e){this.isTextValid_=!0,this.value_=e,this.isBeingEdited_||(this.isDirty_=!0);for(var t,n=this.getOptions(!0),i=0;t=n[i];i++)if(t[1]===this.value_)return void(this.selectedOption_=t);var r=E.oR.getState().elements;this.selectedOption_=[r[parseInt(e)],e]},this.rebuild(),this.setOutput(!0,"Element"),this.setColour(160),this.setTooltip(""),this.setHelpUrl("")},dynamicOptions:function(){var e=E.oR.getState(),t=e.elements,n=e.disabled;return t.filter((function(e,t){return!n[t]})).map((function(e){return[e,t.indexOf(e).toString()]}))},rebuild:function(){var e=this.getInput("DROPDOWN"),t=this.getFieldValue("VALUE");null!==e&&this.removeInput("DROPDOWN");var n=new f.FieldDropdown(this.dynamicOptions());this.appendDummyInput("DROPDOWN").appendField(n,"VALUE"),this.setFieldValue(t,"VALUE")}},f.Blocks.element_cell={init:function(){this.appendDummyInput().appendField("type of"),this.appendValueInput("CELL").setCheck("Vector"),this.setInputsInline(!0),this.setOutput(!0,"Element"),this.setColour(160),this.setTooltip(""),this.setHelpUrl("")}},f.defineBlocksWithJsonArray([{type:"if",message0:"if %1 %2 %3",args0:[{type:"input_dummy"},{type:"input_value",name:"CONDITION",check:"Boolean"},{type:"input_statement",name:"THEN"}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:330,tooltip:"",helpUrl:"",mutator:"if_mutator"}]),f.Extensions.unregister("if_mutator"),f.Extensions.registerMutator("if_mutator",{mutationToDom:function(){var e=f.utils.xml.createElement("mutation"),t=(void 0!==this.elseIds?this.elseIds:[]).join(",");return e.setAttribute("elseIds",t),e},domToMutation:function(e){var t=e.getAttribute("elseIds");null===t&&(t=""),this.elseIds=t.split(",").map((function(e){return parseInt(e)})).filter((function(e){return!isNaN(e)})),this.rebuild()},getFreeElseId:function(){for(var e,t=(e=Math).max.apply(e,function(e){return function(e){if(Array.isArray(e))return me(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return me(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?me(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(this.elseIds)),n=new Set(this.elseIds),i=0;i<t;i++)if(!n.has(i))return i;return this.elseIds.length},rebuild:function(){var e=this;e.removeInput("PLUS",!0);var t=!0,n=!1,i=void 0;try{for(var r,o=this.elseIds[Symbol.iterator]();!(t=(r=o.next()).done);t=!0){var s=r.value,l=this;if(null===e.getInput("ELSE".concat(s))){e.appendDummyInput("ELSE".concat(s)).appendField("else if"),e.appendValueInput("ELSE_CONDITION".concat(s)).setCheck("Boolean");var a=new f.FieldImage("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0Ij48cGF0aCBkPSJNMTggMTFoLTEyYy0xLjEwNCAwLTIgLjg5Ni0yIDJzLjg5NiAyIDIgMmgxMmMxLjEwNCAwIDItLjg5NiAyLTJzLS44OTYtMi0yLTJ6IiBmaWxsPSJ3aGl0ZSIgLz48L3N2Zz4K",15,15,{alt:"".concat(s),flipRtl:"FALSE"});e.appendDummyInput("MINUS".concat(s)).setAlign(f.ALIGN_RIGHT).appendField(a),a.setOnClickHandler((function(t){var n=parseInt(t.altText_.alt);e.removeInput("ELSE".concat(n)),e.removeInput("THEN".concat(n)),e.removeInput("ELSE_CONDITION".concat(n)),e.removeInput("MINUS".concat(n)),l.elseIds=l.elseIds.filter((function(e){return e!==n}))})),null!==a.imageElement_&&(a.imageElement_.style.cursor="pointer"),e.appendStatementInput("THEN".concat(s));var u=E.n2.workspace.newBlock("true_literal"),p=e.getInput("ELSE_CONDITION".concat(s));u.setShadow(!0),u.initSvg(),u.render(),p.connection.connect(u.outputConnection)}}}catch(e){n=!0,i=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw i}}var c=e.appendDummyInput("PLUS");c.setAlign(f.ALIGN_RIGHT);var d=new f.FieldImage("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0Ij48cGF0aCBkPSJNMTggMTBoLTR2LTRjMC0xLjEwNC0uODk2LTItMi0ycy0yIC44OTYtMiAybC4wNzEgNGgtNC4wNzFjLTEuMTA0IDAtMiAuODk2LTIgMnMuODk2IDIgMiAybDQuMDcxLS4wNzEtLjA3MSA0LjA3MWMwIDEuMTA0Ljg5NiAyIDIgMnMyLS44OTYgMi0ydi00LjA3MWw0IC4wNzFjMS4xMDQgMCAyLS44OTYgMi0ycy0uODk2LTItMi0yeiIgZmlsbD0id2hpdGUiIC8+PC9zdmc+Cg==",15,15,{alt:"*",flipRtl:"FALSE"});c.appendField(d),d.setOnClickHandler((function(){var t=e.getFreeElseId();e.elseIds.push(t),e.rebuild()})),null!==d.imageElement_&&(d.imageElement_.style.cursor="pointer")}},(function(){})),f.defineBlocksWithJsonArray([{type:"group",message0:"%1",args0:[{type:"input_value",name:"ITEM0",check:["Element","Number"]}],inputsInline:!0,output:"Group",colour:160,tooltip:"",helpUrl:"",mutator:"group_mutator"}]),f.Extensions.unregister("group_mutator"),f.Extensions.registerMutator("group_mutator",{mutationToDom:function(){var e=f.utils.xml.createElement("mutation");return e.setAttribute("itemCount",this.itemCount),e},domToMutation:function(e){var t=this;t.itemCount=parseInt(e.getAttribute("itemCount")),isNaN(t.itemCount)&&(t.itemCount=1),t.rebuild()},rebuild:function(){var e=this;e.removeInput("PLUS",!0),e.removeInput("MINUS",!0);for(var t=1;null!==e.getInput("ITEM".concat(t));)t>=this.itemCount&&(e.removeInput("ITEM_OR".concat(t)),e.removeInput("ITEM".concat(t))),t++;for(var n=1;n<e.itemCount;n++)if(null===e.getInput("ITEM".concat(n))){e.appendDummyInput("ITEM_OR".concat(n)).appendField("or"),e.appendValueInput("ITEM".concat(n));var i=E.n2.workspace.newBlock("element_literal"),r=e.getInput("ITEM".concat(n));i.setShadow(!0),i.initSvg(),i.render(),r.connection.connect(i.outputConnection)}if(e.itemCount>1){var o=new f.FieldImage("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0Ij48cGF0aCBkPSJNMTggMTFoLTEyYy0xLjEwNCAwLTIgLjg5Ni0yIDJzLjg5NiAyIDIgMmgxMmMxLjEwNCAwIDItLjg5NiAyLTJzLS44OTYtMi0yLTJ6IiBmaWxsPSJ3aGl0ZSIgLz48L3N2Zz4K",15,15,{alt:"*",flipRtl:"FALSE"});e.appendDummyInput("MINUS").appendField(o),o.setOnClickHandler((function(t){e.itemCount--,e.rebuild()})),null!==o.imageElement_&&(o.imageElement_.style.cursor="pointer")}var s=new f.FieldImage("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0Ij48cGF0aCBkPSJNMTggMTBoLTR2LTRjMC0xLjEwNC0uODk2LTItMi0ycy0yIC44OTYtMiAybC4wNzEgNGgtNC4wNzFjLTEuMTA0IDAtMiAuODk2LTIgMnMuODk2IDIgMiAybDQuMDcxLS4wNzEtLjA3MSA0LjA3MWMwIDEuMTA0Ljg5NiAyIDIgMnMyLS44OTYgMi0ydi00LjA3MWw0IC4wNzFjMS4xMDQgMCAyLS44OTYgMi0ycy0uODk2LTItMi0yeiIgZmlsbD0id2hpdGUiIC8+PC9zdmc+Cg==",15,15,{alt:"*",flipRtl:"FALSE"});e.appendDummyInput("PLUS").appendField(s),s.setOnClickHandler((function(t){e.itemCount++,e.rebuild()})),null!==s.imageElement_&&(s.imageElement_.style.cursor="pointer")}},(function(){})),f.Blocks.not_group={init:function(){this.appendDummyInput().appendField("not"),this.appendValueInput("VALUE").setCheck(["Number","String","Boolean","Vector","Element","Group"]),this.setInputsInline(!0),this.setOutput(!0,"Group"),this.setColour(160),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.comparison={init:function(){this.appendValueInput("A").setCheck(["Number","String","Vector","Element","Group"]),this.appendDummyInput().appendField(new f.FieldDropdown([["is","IS"],["is bigger than","BIGGER"],["is smaller than","SMALLER"]]),"COMPARISON"),this.appendValueInput("B").setCheck(["Number","String","Vector","Element","Group"]),this.setOutput(!0,"Boolean"),this.setColour(330),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.change_into={init:function(){this.appendDummyInput().appendField("change"),this.appendValueInput("CELL").setCheck("Vector"),this.appendDummyInput().appendField("into"),this.appendValueInput("ELEMENT").setCheck(["Element","Number"]),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(160),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.swap={init:function(){this.appendDummyInput().appendField("swap"),this.appendValueInput("A").setCheck("Vector"),this.appendDummyInput().appendField("with"),this.appendValueInput("B").setCheck("Vector"),this.setInputsInline(!0),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(160),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.move={init:function(){this.appendDummyInput().appendField("swap"),this.appendValueInput("DIRECTION").setCheck("Vector"),this.setInputsInline(!0),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(160),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.clone={init:function(){this.appendDummyInput().appendField("copy myself"),this.appendValueInput("DIRECTION").setCheck("Vector"),this.setInputsInline(!0),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(160),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.vector_literal={init:function(){this.appendValueInput("X").setCheck("Number"),this.appendValueInput("Y").setCheck("Number"),this.setInputsInline(!0),this.setOutput(!0,"Vector"),this.setColour(260),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.vector_empty={init:function(){this.appendDummyInput(),this.setOutput(!0,"Vector"),this.setColour(260),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.vector_constant={init:function(){this.appendDummyInput().appendField(new f.FieldDropdown([["me","HERE"],["➡ right","RIGHT"],["⬅ left","LEFT"],["⬆ up","UP"],["⬇ down","DOWN"],["⬈ NE ","NE"],["⬊ SE","SE"],["⬋ SW","SW"],["⬉ NW","NW"],["? Neighbor","RAND"],["Arrow Keys","KB"]]),"VALUE"),this.setOutput(!0,"Vector"),this.setColour(260),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.me={init:function(){this.appendDummyInput().appendField("here"),this.setOutput(!0,"Vector"),this.setColour(260),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.get_data_cell={init:function(){var e=this,t=new f.FieldDropdown([["⌛ age","AGE"],["💥 pressure","PRESSURE"],["💫 density","DENSITY"],["💨 wind","WIND"],["⭐ magic","MAGIC"],["⚡ energy","ENERGY"]]);t.setValidator((function(t){"WIND"===t?(e.setColour(260),e.setOutput(!0,"Vector")):(e.setColour(210),e.setOutput(!0,"Number"))})),this.appendDummyInput().appendField(t,"DATA"),this.appendDummyInput().appendField("of"),this.appendValueInput("CELL").setCheck("Vector"),this.setInputsInline(!0),this.setOutput(!0,["Number","Vector"]),this.setColour(210),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.set_data_cell={init:function(){this.appendDummyInput().appendField("set");var e=this,t=new f.FieldDropdown([["⌛ age","AGE"],["💥 pressure","PRESSURE"],["💫 density","DENSITY"],["💨 wind","WIND"],["⭐ magic","MAGIC"],["⚡ energy","ENERGY"]]);t.setValidator((function(t){var n=e.getInput("VALUE");if("WIND"===t&&"#5b80a5"===e.getColour()){e.setColour(260);var i=n.connection.targetBlock();if(null!==i){n.connection.disconnect();var r=n.connection.targetBlock();null!==r?r.dispose(!0):i.dispose(!0)}if(n.setCheck("Vector"),null!==i){var o=E.n2.workspace.newBlock("vector_literal");o.initSvg(),n.connection.connect_(o.outputConnection),o.setShadow(!0);var s=o.getInput("X"),l=o.getInput("Y"),a=E.n2.workspace.newBlock("number_literal"),u=E.n2.workspace.newBlock("number_literal");a.initSvg(),u.initSvg(),a.setShadow(!0),u.setShadow(!0),s.connection.connect_(a.outputConnection),l.connection.connect_(u.outputConnection),a.render(),u.render(),o.render()}}else if("WIND"!==t&&"#5b80a5"!==e.getColour()){e.setColour(210);var p=n.connection.targetBlock();if(null!==p){n.connection.disconnect();var c=n.connection.targetBlock();null!==c?c.dispose(!0):p.dispose(!0)}if(n.setCheck("Number"),null!==p){var d=E.n2.workspace.newBlock("number_literal");d.initSvg(),n.connection.connect_(d.outputConnection),d.setShadow(!0),d.render()}}})),this.appendDummyInput().appendField(t,"DATA"),this.appendDummyInput().appendField("of"),this.appendValueInput("CELL").setCheck("Vector"),this.appendDummyInput().appendField("to"),this.appendValueInput("VALUE").setCheck("Number"),this.setInputsInline(!0),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(210),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.random_number={init:function(){this.appendDummyInput().appendField("random from"),this.appendValueInput("MIN").setCheck(["Number","Element","Group"]),this.appendDummyInput().appendField("to"),this.appendValueInput("MAX").setCheck(["Number","Element","Group"]),this.setOutput(!0,"Number"),this.setColour(210),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.keyboard_vector={init:function(){this.appendDummyInput().appendField("arrow keys direction"),this.setOutput(!0,"Vector"),this.setColour(260),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.cursor_distance={init:function(){this.appendDummyInput().appendField("distance from cursor"),this.setOutput(!0,"Number"),this.setColour(210),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.print={init:function(){this.appendDummyInput().appendField("print"),this.appendValueInput("MESSAGE").setCheck(null),this.setInputsInline(!0),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(0),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.bool_literal={init:function(){this.appendDummyInput().appendField(new f.FieldDropdown([["true","TRUE"],["false","FALSE"]]),"VALUE"),this.setOutput(!0,"Boolean"),this.setColour(330),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.true_literal={init:function(){this.appendDummyInput().appendField("true"),this.setOutput(!0,"Boolean"),this.setColour(330),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.not={init:function(){this.appendDummyInput().appendField("not"),this.appendValueInput("BOOL").setCheck("Boolean"),this.setInputsInline(!0),this.setOutput(!0,"Boolean"),this.setColour(330),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.boolean_operation={init:function(){this.appendValueInput("A").setCheck("Boolean"),this.appendDummyInput().appendField(new f.FieldDropdown([["and","AND"],["or","OR"]]),"OPERATION"),this.appendValueInput("B").setCheck("Boolean"),this.appendDummyInput().appendField(new f.FieldLabelSerializable("➕"),"PLUS"),this.setInputsInline(!0),this.setOutput(!0,"Boolean"),this.setColour(330),this.setTooltip(""),this.setHelpUrl("")}},f.defineBlocksWithJsonArray([{type:"boolean_operation",message0:"%1 %2 %3 %4",args0:[{type:"input_value",name:"A",check:"Boolean"},{type:"field_dropdown",name:"OPERATION",options:[["and","AND"],["or","OR"]]},{type:"input_dummy"},{type:"input_value",name:"B",check:"Boolean"}],inputsInline:!0,output:"Boolean",colour:330,tooltip:"",helpUrl:""}]),f.Blocks.is_touching={init:function(){this.appendDummyInput().appendField("touching"),this.appendValueInput("ELEMENT").setCheck(["Element","Group"]),this.setOutput(!0,"Boolean"),this.setColour(160),this.setTooltip(""),this.setHelpUrl(""),this.setInputsInline(!0)}},f.Blocks.number_touching={init:function(){this.appendDummyInput().appendField("number of"),this.appendValueInput("ELEMENT").setCheck(["Element","Group"]),this.appendDummyInput().appendField("touching"),this.setOutput(!0,"Number"),this.setColour(160),this.setTooltip(""),this.setHelpUrl(""),this.setInputsInline(!0)}},f.Blocks.is_block={init:function(){this.appendValueInput("CELL").setCheck("Vector"),this.appendDummyInput().appendField("is"),this.appendValueInput("ELEMENT").setCheck(["Element","Group"]),this.setOutput(!0,"Boolean"),this.setColour(160),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.one_in={init:function(){this.appendDummyInput().appendField("one in"),this.appendValueInput("NUMBER").setCheck("Number"),this.appendDummyInput().appendField("chance"),this.setInputsInline(!0),this.setOutput(!0,"Boolean"),this.setColour(330),this.setTooltip(""),this.setHelpUrl("")}};var fe=f.Blocks.controls_if.init;f.Blocks.controls_if.init=function(){fe.apply(this),this.setColour(330)},f.defineBlocksWithJsonArray([{type:"operation",message0:"%1 %2 %3 %4",args0:[{type:"input_value",name:"A",check:["Number","Vector"]},{type:"field_dropdown",name:"OPERATION",options:[["+","ADD"],["-","SUBTRACT"],["×","MULTIPLY"],["÷","DIVIDE"],["%","MOD"],["difference","DIFFERENCE"]]},{type:"input_dummy"},{type:"input_value",name:"B",check:["Number","Vector"]}],output:"Number",colour:210,tooltip:"",helpUrl:"",mutator:"operation_mutator"}]),f.Extensions.unregister("operation_mutator"),f.Extensions.registerMutator("operation_mutator",{mutationToDom:function(){var e=f.utils.xml.createElement("mutation");return void 0===this.implicitType&&(this.implicitType="Number"),e.setAttribute("implicitType",this.implicitType),e},domToMutation:function(e){this.implicitType=e.getAttribute("implicitType"),this.rebuild()},rebuild:function(){"Vector"===this.implicitType?(this.setColour(260),this.setOutput(!0,"Vector")):"Number"===this.implicitType&&(this.setColour(210),this.setOutput(!0,"Number"))}},(function(){var e=this;e.setOnChange((function(t){if(t.blockId===e.id||t.newParentId===e.id){var n=(0,he.rk)(e,"A"),i=(0,he.rk)(e,"B");"Number"===n&&"Number"===i?"Number"!==this.implicitType&&(this.implicitType="Number",this.rebuild()):"Vector"!==this.implicitType&&(this.implicitType="Vector",this.rebuild())}}))})),f.Blocks.rotated_by={init:function(){this.appendDummyInput().appendField("rotated by"),this.appendValueInput("NUMBER").setCheck("Number"),this.appendStatementInput("BODY").setCheck(null),this.setInputsInline(!0),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(260),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.in_a_random={init:function(){this.appendDummyInput().appendField("in a random"),this.appendDummyInput().appendField(new f.FieldDropdown([["↻ rotation","ROTATION"],["✥ reflection","REFLECTION"],["⟷ horizontal reflection","HORIZONTAL_REFLECTION"],["↕ vertical reflection","VERTICAL_REFLECTION"]]),"NAME"),this.appendStatementInput("NAME").setCheck(null),this.setInputsInline(!0),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(260),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.for_all={init:function(){this.appendDummyInput().appendField("for each"),this.appendDummyInput().appendField(new f.FieldDropdown([["↻ rotation","ROTATION"],["✥ reflection","REFLECTION"],["⟷ horizontal reflection","HORIZONTAL_REFLECTION"],["↕ vertical reflection","VERTICAL_REFLECTION"]]),"NAME"),this.appendStatementInput("NAME").setCheck(null),this.setInputsInline(!0),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(260),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.macro={init:function(){this.appendDummyInput().appendField("make a block called").appendField(new f.FieldTextInput("foo"),"NAME").appendField("that means"),this.appendValueInput("VALUE").setCheck(null),this.setInputsInline(!0),this.setColour(0),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.macro_function={init:function(){this.appendDummyInput().appendField("make a block called").appendField(new f.FieldTextInput("foo"),"NAME").appendField("that does"),this.appendStatementInput("NAME").setCheck(null),this.setInputsInline(!0),this.setColour(0),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.macro_function={init:function(){this.appendDummyInput().appendField("make a block called").appendField(new f.FieldTextInput("foo"),"NAME").appendField("that does"),this.appendStatementInput("NAME").setCheck(null),this.appendDummyInput().setAlign(f.ALIGN_RIGHT).appendField("➕"),this.setInputsInline(!0),this.setColour(0),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.value_statement={init:function(){this.appendStatementInput("STATEMENT").setCheck(null),this.setInputsInline(!0),this.setOutput(!0,null),this.setColour(0),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.statement_value={init:function(){this.appendValueInput("VALUE").setCheck(null),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(0),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.value_statement_shadow={init:function(){this.appendDummyInput().appendField("expression"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(0),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.statement_value_shadow={init:function(){this.appendDummyInput().appendField("value"),this.setOutput(!0,null),this.setColour(0),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.repeat={init:function(){this.appendValueInput("NUMBER").setCheck("Number").appendField("repeat"),this.appendDummyInput().appendField("times"),this.appendStatementInput("STATEMENT").setCheck(null),this.setInputsInline(!0),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(330),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.boolean_operation_vertical={init:function(){this.appendValueInput("A").setCheck("Boolean").setAlign(f.ALIGN_CENTRE),this.appendDummyInput().setAlign(f.ALIGN_CENTRE).appendField(new f.FieldDropdown([["and","AND"],["or","OR"]]),"OPERATION"),this.appendValueInput("B").setCheck("Boolean").setAlign(f.ALIGN_CENTRE),this.appendDummyInput().setAlign(f.ALIGN_CENTRE).appendField(new f.FieldDropdown([["and","AND"],["or","OR"]]),"OPERATION2"),this.appendValueInput("C").setCheck("Boolean").setAlign(f.ALIGN_CENTRE),this.setInputsInline(!1),this.setOutput(!0,"Boolean"),this.setColour(330),this.setTooltip(""),this.setHelpUrl("")}};var ye=[["Type","ELEMENT"],["Color Fade »","RA"],["Hue Rotate","RB"],["Extra Data","RC"]];f.Blocks.get_r_cell={init:function(){this.appendDummyInput().appendField(new f.FieldDropdown(ye),"DATA"),this.appendDummyInput().appendField("of"),this.appendValueInput("CELL").setCheck("Vector"),this.setInputsInline(!0),this.setOutput(!0,"Number"),this.setColour(210),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.set_r_cell={init:function(){this.appendDummyInput().appendField("set"),this.appendDummyInput().appendField(new f.FieldDropdown(ye),"DATA"),this.appendDummyInput().appendField("of"),this.appendValueInput("CELL").setCheck("Vector"),this.appendDummyInput().appendField("to"),this.appendValueInput("VALUE").setCheck(["Number","Element"]),this.setInputsInline(!0),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(210),this.setTooltip(""),this.setHelpUrl("")}},f.defineBlocksWithJsonArray([{type:"that",message0:"%1",args0:[{type:"field_label_serializable",name:"TEXT",text:"that"}],inputsInline:!0,output:"Number",colour:210,tooltip:"",helpUrl:"",mutator:"that_mutator"},{type:"that_pointer",message0:"%1",args0:[{type:"input_dummy"}],output:null,colour:210,tooltip:"",helpUrl:""}]),f.Extensions.unregister("that_mutator"),f.Extensions.registerMutator("that_mutator",{mutationToDom:function(){var e=f.utils.xml.createElement("mutation");return e.setAttribute("target",this.target),e.setAttribute("pointer",this.pointer),e},domToMutation:function(e){this.target=e.getAttribute("target"),this.pointer=e.getAttribute("pointer"),this.rebuild()},rebuild:function(){if("undefined"===this.pointer){var e=E.n2.workspace.newBlock("that_pointer");e.initSvg(),e.render(),this.pointer=e.id}else E.n2.workspace.getBlockById(this.pointer).moveBy(1,0)}}),f.Blocks.key_pressed={init:function(){this.appendDummyInput().appendField(new f.FieldDropdown([["space bar","SPACE"],["➡ right arrow","ArrowRight"],["⬅ left arrow","ArrowLeft"],["⬆ up arrow","ArrowUp"],["⬇ down arrow","ArrowDown"]]),"KEY"),this.appendDummyInput().appendField(new f.FieldLabelSerializable("is pressed"),"TEXT"),this.setInputsInline(!0),this.setOutput(!0,"Boolean"),this.setColour(330),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.get_r_cell_short={init:function(){this.appendDummyInput().appendField(new f.FieldDropdown(ye),"DATA"),this.setInputsInline(!0),this.setOutput(!0,"Number"),this.setColour(210),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.set_r_cell_short={init:function(){this.appendDummyInput().appendField("set"),this.appendDummyInput().appendField(new f.FieldDropdown(ye),"DATA"),this.appendDummyInput().appendField("to"),this.appendValueInput("VALUE").setCheck(["Number","Element"]),this.setInputsInline(!0),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(210),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.modify_r={init:function(){this.appendDummyInput().appendField("increase").appendField(new f.FieldDropdown(ye),"DATA"),this.appendDummyInput().appendField("by"),this.appendValueInput("VALUE").setCheck(["Number","Element"]),this.setInputsInline(!0),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(210),this.setTooltip(""),this.setHelpUrl("")}},f.defineBlocksWithJsonArray([{type:"get_r_cell_flexible",message0:"%1",args0:[{type:"field_dropdown",name:"DATA",options:ye}],inputsInline:!0,output:"Number",colour:210,tooltip:"",helpUrl:"",mutator:"get_r_mutator"}]),f.Extensions.unregister("get_r_mutator"),f.Extensions.registerMutator("get_r_mutator",{mutationToDom:function(){var e=f.utils.xml.createElement("mutation");return e.setAttribute("expanded",this.expanded),e},domToMutation:function(e){var t=e.getAttribute("expanded");this.expanded="true"===t,this.rebuild()},rebuild:function(){if(this.removeInput("PLUS",!0),this.removeInput("MINUS",!0),this.removeInput("OF",!0),this.removeInput("CELL",!0),this.expanded){var e=this;this.appendDummyInput("OF").appendField("of");var t=this.appendValueInput("CELL").setCheck("Vector"),n=E.n2.workspace.newBlock("vector_constant");n.setShadow(!0),n.initSvg(),n.render(),t.connection.connect(n.outputConnection);var i=new f.FieldImage("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0Ij48cGF0aCBkPSJNMTggMTFoLTEyYy0xLjEwNCAwLTIgLjg5Ni0yIDJzLjg5NiAyIDIgMmgxMmMxLjEwNCAwIDItLjg5NiAyLTJzLS44OTYtMi0yLTJ6IiBmaWxsPSJ3aGl0ZSIgLz48L3N2Zz4K",15,15,{alt:"*",flipRtl:"FALSE"});this.appendDummyInput("MINUS").appendField(i),i.setOnClickHandler((function(){e.expanded=!1,e.rebuild()})),null!==i.imageElement_&&(i.imageElement_.style.cursor="pointer")}else{var r=this,o=new f.FieldImage("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0Ij48cGF0aCBkPSJNMTggMTBoLTR2LTRjMC0xLjEwNC0uODk2LTItMi0ycy0yIC44OTYtMiAybC4wNzEgNGgtNC4wNzFjLTEuMTA0IDAtMiAuODk2LTIgMnMuODk2IDIgMiAybDQuMDcxLS4wNzEtLjA3MSA0LjA3MWMwIDEuMTA0Ljg5NiAyIDIgMnMyLS44OTYgMi0ydi00LjA3MWw0IC4wNzFjMS4xMDQgMCAyLS44OTYgMi0ycy0uODk2LTItMi0yeiIgZmlsbD0id2hpdGUiIC8+PC9zdmc+Cg==",15,15,{alt:"*",flipRtl:"FALSE"});this.appendDummyInput("PLUS").appendField(o),o.setOnClickHandler((function(){r.expanded=!0,r.rebuild()})),null!==o.imageElement_&&(o.imageElement_.style.cursor="pointer")}}}),f.defineBlocksWithJsonArray([{type:"set_r_cell_flexible",message0:"set %1 %2 %3 to %4 %5",args0:[{type:"input_dummy"},{type:"field_dropdown",name:"DATA",options:ye},{type:"input_dummy"},{type:"input_dummy",name:"TO"},{type:"input_value",name:"VALUE",check:["Number","Vector","Group","Element"]}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:210,tooltip:"",helpUrl:"",mutator:"set_r_mutator"}]),f.defineBlocksWithJsonArray([{type:"set_r_cell_flexible_hue_fix",message0:"set %1 %2 %3 to %4 %5",args0:[{type:"input_dummy"},{type:"field_dropdown",name:"DATA",options:ye},{type:"input_dummy"},{type:"input_dummy",name:"TO"},{type:"input_value",name:"VALUE",check:["Number","Vector","Group","Element"]}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:210,tooltip:"",helpUrl:"",mutator:"set_r_mutator"}]),f.Extensions.unregister("set_r_mutator"),f.Extensions.registerMutator("set_r_mutator",{mutationToDom:function(){var e=f.utils.xml.createElement("mutation");return e.setAttribute("expanded",this.expanded),e},domToMutation:function(e){var t=e.getAttribute("expanded");this.expanded="true"===t,this.rebuild()},rebuild:function(){this.removeInput("PLUS",!0),this.removeInput("MINUS",!0),this.removeInput("OF",!0),this.removeInput("CELL",!0),this.removeInput("TO",!0);var e=this.getInput("VALUE").connection.targetBlock(),t=void 0;if(null!==e&&e.isShadow()&&(t=e.getFieldValue("VALUE")),this.removeInput("VALUE",!0),this.expanded){this.appendDummyInput("OF").appendField("of");var n=this.appendValueInput("CELL").setCheck("Vector"),i=E.n2.workspace.newBlock("vector_constant");i.setShadow(!0),i.initSvg(),i.render(),n.connection.connect(i.outputConnection)}this.appendDummyInput("TO").appendField("to");var r=this.appendValueInput("VALUE").setCheck(["Number","Element","Group"]),o=E.n2.workspace.newBlock("number_literal");if(o.setShadow(!0),o.initSvg(),o.render(),r.connection.connect(o.outputConnection),void 0!==t&&o.setFieldValue(t,"VALUE"),null!==e&&r.connection.connect(e.outputConnection),this.expanded){var s=this,l=new f.FieldImage("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0Ij48cGF0aCBkPSJNMTggMTFoLTEyYy0xLjEwNCAwLTIgLjg5Ni0yIDJzLjg5NiAyIDIgMmgxMmMxLjEwNCAwIDItLjg5NiAyLTJzLS44OTYtMi0yLTJ6IiBmaWxsPSJ3aGl0ZSIgLz48L3N2Zz4K",15,15,{alt:"*",flipRtl:"FALSE"});this.appendDummyInput("MINUS").appendField(l),l.setOnClickHandler((function(){s.expanded=!1,s.rebuild()})),null!==l.imageElement_&&(l.imageElement_.style.cursor="pointer")}else{var a=this,u=new f.FieldImage("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0Ij48cGF0aCBkPSJNMTggMTBoLTR2LTRjMC0xLjEwNC0uODk2LTItMi0ycy0yIC44OTYtMiAybC4wNzEgNGgtNC4wNzFjLTEuMTA0IDAtMiAuODk2LTIgMnMuODk2IDIgMiAybDQuMDcxLS4wNzEtLjA3MSA0LjA3MWMwIDEuMTA0Ljg5NiAyIDIgMnMyLS44OTYgMi0ydi00LjA3MWw0IC4wNzFjMS4xMDQgMCAyLS44OTYgMi0ycy0uODk2LTItMi0yeiIgZmlsbD0id2hpdGUiIC8+PC9zdmc+Cg==",15,15,{alt:"*",flipRtl:"FALSE"});this.appendDummyInput("PLUS").appendField(u),u.setOnClickHandler((function(){a.expanded=!0,a.rebuild()})),null!==u.imageElement_&&(u.imageElement_.style.cursor="pointer")}}}),f.defineBlocksWithJsonArray([{type:"modify_r_cell_flexible",message0:"increase %1 %2 %3 by %4 %5",args0:[{type:"input_dummy"},{type:"field_dropdown",name:"DATA",options:ye},{type:"input_dummy"},{type:"input_dummy",name:"BY"},{type:"input_value",name:"VALUE",check:["Number","Vector"]}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:210,tooltip:"",helpUrl:"",mutator:"modify_r_mutator"}]),f.defineBlocksWithJsonArray([{type:"modify_r_cell_flexible_hue_fix",message0:"increase %1 %2 %3 by %4 %5",args0:[{type:"input_dummy"},{type:"field_dropdown",name:"DATA",options:ye},{type:"input_dummy"},{type:"input_dummy",name:"BY"},{type:"input_value",name:"VALUE",check:["Number","Vector"]}],inputsInline:!0,previousStatement:null,nextStatement:null,colour:210,tooltip:"",helpUrl:"",mutator:"modify_r_mutator"}]),f.Extensions.unregister("modify_r_mutator"),f.Extensions.registerMutator("modify_r_mutator",{mutationToDom:function(){var e=f.utils.xml.createElement("mutation");return e.setAttribute("expanded",this.expanded),e},domToMutation:function(e){var t=e.getAttribute("expanded");this.expanded="true"===t,this.rebuild()},rebuild:function(){this.removeInput("PLUS",!0),this.removeInput("MINUS",!0),this.removeInput("OF",!0),this.removeInput("CELL",!0),this.removeInput("BY",!0);var e=this.getInput("VALUE").connection.targetBlock(),t=void 0;if(null!==e&&e.isShadow()&&(t=e.getFieldValue("VALUE")),this.removeInput("VALUE",!0),this.expanded){this.appendDummyInput("OF").appendField("of");var n=this.appendValueInput("CELL").setCheck("Vector"),i=E.n2.workspace.newBlock("vector_constant");i.setShadow(!0),i.initSvg(),i.render(),n.connection.connect(i.outputConnection)}this.appendDummyInput("BY").appendField("by");var r=this.appendValueInput("VALUE").setCheck(["Number","Element"]),o=E.n2.workspace.newBlock("number_literal");if(o.setShadow(!0),o.initSvg(),o.render(),r.connection.connect(o.outputConnection),void 0!==t&&o.setFieldValue(t,"VALUE"),null!==e&&r.connection.connect(e.outputConnection),this.expanded){var s=this,l=new f.FieldImage("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0Ij48cGF0aCBkPSJNMTggMTFoLTEyYy0xLjEwNCAwLTIgLjg5Ni0yIDJzLjg5NiAyIDIgMmgxMmMxLjEwNCAwIDItLjg5NiAyLTJzLS44OTYtMi0yLTJ6IiBmaWxsPSJ3aGl0ZSIgLz48L3N2Zz4K",15,15,{alt:"*",flipRtl:"FALSE"});this.appendDummyInput("MINUS").appendField(l),l.setOnClickHandler((function(){s.expanded=!1,s.rebuild()})),null!==l.imageElement_&&(l.imageElement_.style.cursor="pointer")}else{var a=this,u=new f.FieldImage("data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZlcnNpb249IjEuMSIgd2lkdGg9IjI0IiBoZWlnaHQ9IjI0Ij48cGF0aCBkPSJNMTggMTBoLTR2LTRjMC0xLjEwNC0uODk2LTItMi0ycy0yIC44OTYtMiAybC4wNzEgNGgtNC4wNzFjLTEuMTA0IDAtMiAuODk2LTIgMnMuODk2IDIgMiAybDQuMDcxLS4wNzEtLjA3MSA0LjA3MWMwIDEuMTA0Ljg5NiAyIDIgMnMyLS44OTYgMi0ydi00LjA3MWw0IC4wNzFjMS4xMDQgMCAyLS44OTYgMi0ycy0uODk2LTItMi0yeiIgZmlsbD0id2hpdGUiIC8+PC9zdmc+Cg==",15,15,{alt:"*",flipRtl:"FALSE"});this.appendDummyInput("PLUS").appendField(u),u.setOnClickHandler((function(){a.expanded=!0,a.rebuild()})),null!==u.imageElement_&&(u.imageElement_.style.cursor="pointer")}}}),f.Blocks.comment={init:function(){this.appendDummyInput().appendField(new f.FieldLabelSerializable("note:"),"NOTE").appendField(new f.FieldTextInput("    "),"COMMENT"),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour("#00b7ff"),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.after={init:function(){this.appendDummyInput().appendField(new f.FieldLabelSerializable("at the end of the frame"),"TEXT"),this.appendStatementInput("STATEMENT").setCheck(null),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(330),this.setTooltip(""),this.setHelpUrl("")}},f.Blocks.every_n_frames={init:function(){this.appendValueInput("NUMBER").setCheck("Number").appendField("every"),this.appendDummyInput().appendField("frames"),this.appendStatementInput("STATEMENT").setCheck(null),this.setInputsInline(!0),this.setPreviousStatement(!0,null),this.setNextStatement(!0,null),this.setColour(330),this.setTooltip(""),this.setHelpUrl("")}};var Ie=n(3139);function ge(){return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(le,{type:"group",children:(0,o.jsx)(ae,{name:"ITEM0",children:(0,o.jsx)(pe,{type:"element_literal",children:(0,o.jsx)(ue,{name:"VALUE",children:"3"})})})}),(0,o.jsx)(le,{type:"move",children:(0,o.jsx)(ae,{name:"DIRECTION",children:(0,o.jsx)(pe,{type:"vector_constant",children:(0,o.jsx)(ue,{name:"VALUE",children:"DOWN"})})})}),(0,o.jsx)(le,{type:"clone",children:(0,o.jsx)(ae,{name:"DIRECTION",children:(0,o.jsx)(pe,{type:"vector_constant",children:(0,o.jsx)(ue,{name:"VALUE",children:"DOWN"})})})}),(0,o.jsxs)(le,{type:"change_into",children:[(0,o.jsx)(ae,{name:"CELL",children:(0,o.jsx)(pe,{type:"vector_constant",children:(0,o.jsx)(ue,{name:"VALUE",children:"HERE"})})}),(0,o.jsx)(ae,{name:"ELEMENT",children:(0,o.jsx)(pe,{type:"element_literal",children:(0,o.jsx)(ue,{name:"VALUE",children:"3"})})})]}),(0,o.jsxs)(le,{type:"is_block",children:[(0,o.jsx)(ae,{name:"CELL",children:(0,o.jsx)(pe,{type:"vector_constant",children:(0,o.jsx)(ue,{name:"VALUE",children:"DOWN"})})}),(0,o.jsx)(ae,{name:"ELEMENT",children:(0,o.jsx)(pe,{type:"element_literal",children:(0,o.jsx)(ue,{name:"VALUE",children:"0"})})})]}),(0,o.jsx)(le,{type:"is_touching",children:(0,o.jsx)(ae,{name:"ELEMENT",children:(0,o.jsx)(pe,{type:"element_literal",children:(0,o.jsx)(ue,{name:"VALUE",children:"2"})})})}),(0,o.jsx)(le,{type:"number_touching",children:(0,o.jsx)(ae,{name:"ELEMENT",children:(0,o.jsx)(pe,{type:"element_literal",children:(0,o.jsx)(ue,{name:"VALUE",children:"2"})})})}),(0,o.jsx)(le,{type:"element_cell",children:(0,o.jsx)(ae,{name:"CELL",children:(0,o.jsx)(pe,{type:"vector_constant",children:(0,o.jsx)(ue,{name:"VALUE",children:"DOWN"})})})}),(0,o.jsx)(le,{type:"comment"}),(0,o.jsx)(le,{type:"if"}),(0,o.jsx)(le,{type:"one_in",children:(0,o.jsx)(ae,{name:"NUMBER",children:(0,o.jsx)(pe,{type:"number_literal_positive",children:(0,o.jsx)(ue,{name:"VALUE",children:"2"})})})}),(0,o.jsx)(le,{type:"key_pressed"}),(0,o.jsxs)(le,{type:"comparison",children:[(0,o.jsx)(ue,{name:"COMPARISON",children:"IS"}),(0,o.jsx)(ae,{name:"B",children:(0,o.jsx)(pe,{type:"number_literal",children:(0,o.jsx)(ue,{name:"VALUE",children:"0"})})})]}),(0,o.jsx)(le,{type:"boolean_operation",children:(0,o.jsx)(ue,{name:"OPERATION",children:"AND"})}),(0,o.jsx)(le,{type:"bool_literal",children:(0,o.jsx)(ue,{name:"VALUE",children:"TRUE"})}),(0,o.jsx)(le,{type:"not"}),(0,o.jsx)(le,{type:"vector_constant",children:(0,o.jsx)(ue,{name:"VALUE",children:"HERE"})}),(0,o.jsx)(le,{type:"keyboard_vector"}),(0,o.jsx)(le,{type:"in_a_random",children:(0,o.jsx)(ue,{name:"NAME",children:"ROTATION"})}),(0,o.jsx)(le,{type:"for_all",children:(0,o.jsx)(ue,{name:"NAME",children:"ROTATION"})}),(0,o.jsx)(le,{type:"rotated_by",children:(0,o.jsx)(ae,{name:"NUMBER",children:(0,o.jsx)(pe,{type:"number_literal",children:(0,o.jsx)(ue,{name:"VALUE",children:"0"})})})}),(0,o.jsx)(le,{type:"number_literal",children:(0,o.jsx)(ue,{name:"VALUE",children:"0"})}),(0,o.jsxs)(le,{type:"operation",children:[(0,o.jsx)(ue,{name:"OPERATION",children:"ADD"}),(0,o.jsx)(ae,{name:"A",children:(0,o.jsx)(pe,{type:"number_literal",children:(0,o.jsx)(ue,{name:"VALUE",children:"0"})})}),(0,o.jsx)(ae,{name:"B",children:(0,o.jsx)(pe,{type:"number_literal",children:(0,o.jsx)(ue,{name:"VALUE",children:"0"})})})]}),(0,o.jsxs)(le,{type:"random_number",children:[(0,o.jsx)(ae,{name:"MIN",children:(0,o.jsx)(pe,{type:"number_literal",children:(0,o.jsx)(ue,{name:"VALUE",children:"-1"})})}),(0,o.jsx)(ae,{name:"MAX",children:(0,o.jsx)(pe,{type:"number_literal",children:(0,o.jsx)(ue,{name:"VALUE",children:"1"})})})]}),(0,o.jsx)(le,{type:"get_r_cell_flexible",children:(0,o.jsx)(ue,{name:"DATA",children:"RA"})}),(0,o.jsxs)(le,{type:"modify_r_cell_flexible_hue_fix",children:[(0,o.jsx)(ue,{name:"DATA",children:"RA"}),(0,o.jsx)(ae,{name:"VALUE",children:(0,o.jsx)(pe,{type:"number_literal",children:(0,o.jsx)(ue,{name:"VALUE",children:"0"})})})]}),(0,o.jsxs)(le,{type:"set_r_cell_flexible_hue_fix",children:[(0,o.jsx)(ue,{name:"DATA",children:"RA"}),(0,o.jsx)(ae,{name:"VALUE",children:(0,o.jsx)(pe,{type:"number_literal_positive",children:(0,o.jsx)(ue,{name:"VALUE",children:"0"})})})]}),(0,o.jsx)(le,{type:"repeat",children:(0,o.jsx)(ae,{name:"NUMBER",children:(0,o.jsx)(pe,{type:"number_literal_positive",children:(0,o.jsx)(ue,{name:"VALUE",children:"2"})})})}),(0,o.jsx)(le,{type:"every_n_frames",children:(0,o.jsx)(ae,{name:"NUMBER",children:(0,o.jsx)(pe,{type:"number_literal_positive",children:(0,o.jsx)(ue,{name:"VALUE",children:"3"})})})}),(0,o.jsx)(le,{type:"after"})]})}function ve(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}var be=function(){var e=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o=[],s=!0,l=!1;try{for(n=n.call(e);!(s=(i=n.next()).done)&&(o.push(i.value),!t||o.length!==t);s=!0);}catch(e){l=!0,r=e}finally{try{s||null==n.return||n.return()}finally{if(l)throw r}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return ve(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?ve(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,c.Kx)({edit:(0,c.Wc)(c.dJ,!1),id:c.yz}),2),t=e[0],n=(e[1],!t.edit),i=(0,s.useRef)(),r=(0,d.useRouter)(),l=(0,E.ZP)((function(e){return e.selectedElement})),a=E.ZP.getState().xmls;(0,s.useEffect)((function(){var e=E.ZP.getState().post,t=i.current.primaryWorkspace;if(E.n2.workspace=t,null===e){var n="/post/[id]"===r.route?r.query.id:void 0;(0,Ie.D)(n)}}),[]),(0,s.useEffect)((function(){if(i.current&&!n){var e=i.current.primaryWorkspace;E.n2.workspace=e;var t=function(){return(0,he.bB)(l,e)};return e.addChangeListener(t),function(){e.removeChangeListener(t)}}}),[i,l,n,a]),(0,s.useEffect)((function(){if(i.current&&!n){var e;i.current.primaryWorkspace.clear();var t=E.ZP.getState().xmls[null!==(e=E.ZP.getState().selectedElement)&&void 0!==e?e:0];t&&f.Xml.domToWorkspace(f.Xml.textToDom(t),i.current.primaryWorkspace)}}),[l,n]);var u=(0,E.ZP)((function(e){return e.loading}))?"brightness(1.0) contrast(0.1) saturate(0.1)":"";return(0,o.jsxs)("div",{className:"App",children:[(0,o.jsx)(se,{style:{filter:u,opacity:n?"0.0":"1.0",transition:"transform 0.5s ease-in-out, opacity 0.5s ease-in-out"},ref:i,collapse:!1,comments:!1,disable:!1,maxBlocks:1/0,readOnly:!1,trashcan:!1,media:"/media/",renderer:"custom_renderer",move:{scrollbars:!0,drag:!0,wheel:!0},zoom:{controls:!0},initialXml:y.Z[1],children:(0,o.jsx)(ge,{})}),(0,o.jsx)(H,{playMode:n})]})},Ee=n(3698),xe=n(8531),je=n(352),Ne=n(2357);function Ae(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function Ce(e,t,n,i,r,o,s){try{var l=e[o](s),a=l.value}catch(e){return void n(e)}l.done?t(a):Promise.resolve(a).then(i,r)}function Te(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function we(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter((function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable})))),i.forEach((function(t){Te(e,t,n[t])}))}return e}var Le={id:1,placeholder:!0,title:"",metadata:{elements:["a","b","c"],disabled:[],colors:["red","green","blue"],color2s:["red","green","blue"]},_count:{stars:0},stars:[]},Me={posts:[we({},Le,{key:"placeholder1"}),we({},Le,{key:"placeholder2"}),we({},Le,{key:"placeholder3"}),we({},Le,{key:"placeholder4"})]},Se=["new","top"],ke=[{value:"1",label:"day"},{value:"7",label:"week"},{value:"30",label:"month"},{value:"365",label:"year"}],_e=function(){var e=window.innerWidth<=700,t=(0,d.useRouter)(),n=(0,p.useSession)().data,i=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o=[],s=!0,l=!1;try{for(n=n.call(e);!(s=(i=n.next()).done)&&(o.push(i.value),!t||o.length!==t);s=!0);}catch(e){l=!0,r=e}finally{try{s||null==n.return||n.return()}finally{if(l)throw r}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Ae(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Ae(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,c.Kx)({order:(0,c.Wc)(c.Zp,"new"),days:c.Zp,edit:(0,c.Wc)(c.dJ,!1),id:c.yz,admin:c.dJ}),2),h=i[0],f=i[1],y={};void 0!==h.admin&&(y.admin=h.admin?1:0);var I="/"===t.route,g=I||"/featured"===t.route,v="/all"===t.route,b=!h.edit,E=t.query.userid,x="/user/[userid]/likes"===t.route,j="/post/[id]"===t.route,N=t.query.id;I&&void 0!==h.id&&t.push({pathname:"/post/".concat(h.id),query:y},void 0,{scroll:!1});var A=(0,l.useInfiniteQuery)(["browseData",h,t],function(){var e,t=(e=r().mark((function e(t){var n,i,o,s;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.pageParam,i=void 0===n?0:n,e.next=3,m()("/api/query",{params:we({},h,{featured:g,order:I?"top":h.order,days:I?"30":h.days,take:10,skip:i,id:j?N:void 0,userId:x?void 0:E,starredBy:x?E:void 0,admin:!(!h.admin&&void 0!==h.admin)||void 0})});case 3:return o=e.sent,(s=o.data).posts=s.posts.map((function(e){return e.metadata=JSON.parse(e.metadata),e})),e.abrupt("return",s);case 7:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(i,r){var o=e.apply(t,n);function s(e){Ce(o,i,r,s,l,"next",e)}function l(e){Ce(o,i,r,s,l,"throw",e)}s(void 0)}))});return function(e){return t.apply(this,arguments)}}(),{getPreviousPageParam:function(e){return e.offset||0},getNextPageParam:function(e){return(null==e?void 0:e.offset)||0}}),C=A.isLoading,T=A.error,w=A.data,L=(A.isFetching,A.isFetchingNextPage),M=A.fetchNextPage,S=A.hasNextPage,k=(0,a.YD)(),_=k.ref,D=k.inView;s.useEffect((function(){D&&M()}),[D]);var O=null!=w?w:{pages:[Me]};return(0,o.jsxs)("div",{className:"browse-page",style:{flexDirection:b?"":"column-reverse"},children:[(0,o.jsxs)("div",{className:"browse family",style:{display:b?"":"none"},children:[(0,o.jsxs)("span",{className:"nav-bar",children:[(0,o.jsxs)("div",{className:"nav-bar-group",children:[(0,o.jsxs)("button",{className:I?"selected":"",onClick:function(e){e.preventDefault(),t.push({pathname:"/",query:y},void 0,{scroll:!1})},children:[" ","Home"]}),(0,o.jsxs)("button",{className:!I&&g?"selected":"",onClick:function(e){e.preventDefault(),t.push({pathname:"/featured",query:y},void 0,{scroll:!1})},children:[" ","Featured"]}),(0,o.jsxs)("button",{className:v?"selected":"",onClick:function(e){e.preventDefault(),t.push({pathname:"/all",query:y},void 0,{scroll:!1})},children:[" ","All"]})]}),(0,o.jsxs)("div",{className:"nav-bar-group",children:[n?(0,o.jsxs)("button",{className:x||E!==n.userId?"":"selected",onClick:function(e){e.preventDefault(),t.push({pathname:"/user/".concat(n.userId),query:y},void 0,{scroll:!1})},children:[" ","My Profile"]}):(0,o.jsx)("button",{onClick:function(e){e.preventDefault(),(0,p.signIn)()},children:"Sign In"}),!e&&(0,o.jsx)("button",{className:"editor-toggle",onClick:function(e){f({edit:b?1:void 0})},children:"<- Open Editor"})]})]}),(0,o.jsx)("span",{style:{},children:!j&&!I&&(0,o.jsxs)("span",{className:"filterControls",children:[(0,o.jsx)(u.Z,{options:Se,onChange:function(e){"top"===e.value?f({order:e.value,days:"1"}):f({order:e.value,days:void 0})},value:h.order}),"top"===h.order&&(0,o.jsx)(u.Z,{options:ke,onChange:function(e){return f({days:e.value})},value:h.days})]})}),C&&(0,o.jsx)(xe.default,{}),T&&(0,o.jsxs)("div",{children:["Error: ",T]}),I&&(0,o.jsx)(je.default,{}),E&&(0,o.jsx)(Ne.default,{}),null==O?void 0:O.pages.map((function(e,t){return(0,o.jsx)(s.Fragment,{children:e.posts.map((function(e){return(0,o.jsx)(Ee.default,{post:e,full:!0},void 0===e.key?e.id:e.key)}))},"page".concat(t))})),!j&&(0,o.jsx)("div",{children:(0,o.jsx)("button",{ref:_,onClick:function(){return M()},disabled:!S||L,children:L?"Loading more...":S?"Load Newer":"Nothing more to load"})})]}),(0,o.jsx)(be,{})]})}},352:function(e,t,n){n.r(t),n.d(t,{default:function(){return r}});var i=n(5893);function r(){return(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)("div",{className:"post splash",children:[(0,i.jsx)("p",{children:(0,i.jsx)("b",{children:"Welcome to Sandspiel Studio! 🧪"})}),(0,i.jsxs)("p",{children:["Sandspiel Studio is a new tool for creating ","&"," sharing Sandspiel elements."]}),(0,i.jsxs)("p",{children:["Check out our"," ",(0,i.jsx)("a",{href:"https://www.youtube.com/watch?v=48-9jjndb2k",children:"YouTube channel"})," ","for tutorials and updates, and if you want to support the project or join our private discord server,"," ",(0,i.jsx)("a",{href:"https://sandspiel.gumroad.com/l/studio-early-access",children:"sign up here"}),"!"]}),(0,i.jsx)("p",{children:"Please be respectful and kind towards other users. We are very excited to see what you invent!"})]})})}n(7294)},1896:function(e,t,n){n.r(t),n.d(t,{LoadingCurtain:function(){return o}});var i=n(5893),r=(n(7294),n(8824)),o=function(){var e=(0,r.ZP)((function(e){return e.curtainColor})),t=(0,r.ZP)((function(e){return e.loading})),n=(0,r.ZP)((function(e){return e.post}));return(0,i.jsxs)("div",{className:"loading-curtain-container",children:[(0,i.jsx)("div",{className:"loading-curtain loading-curtain-top background-"+e+(t?" visible":""),children:(0,i.jsx)("div",{children:"Loading..."})}),(0,i.jsx)("div",{className:"loading-curtain loading-curtain-bottom background-"+e+(t?" visible":""),children:(0,i.jsx)("div",{children:n&&(0,i.jsxs)("div",{children:[(0,i.jsxs)("b",{children:['"',n.title?n.title:"Untitled",'"']}),(0,i.jsx)("br",{}),"by ",n.user.name?n.user.name:n.user.id.slice(0,6)]})})})]})};t.default=o},2357:function(e,t,n){n.r(t),n.d(t,{default:function(){return y}});var i=n(4051),r=n.n(i),o=n(5893),s=n(7294),l=n(3299),a=n(1163),u=n(8767),p=n(4873),c=n(9669),d=n.n(c);function h(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,i=new Array(t);n<t;n++)i[n]=e[n];return i}function m(e,t,n,i,r,o,s){try{var l=e[o](s),a=l.value}catch(e){return void n(e)}l.done?t(a):Promise.resolve(a).then(i,r)}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var i,r,o=[],s=!0,l=!1;try{for(n=n.call(e);!(s=(i=n.next()).done)&&(o.push(i.value),!t||o.length!==t);s=!0);}catch(e){l=!0,r=e}finally{try{s||null==n.return||n.return()}finally{if(l)throw r}}return o}}(e,t)||function(e,t){if(e){if("string"==typeof e)return h(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?h(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function y(){var e,t,n=f((0,p.Kx)({admin:(0,p.Wc)(p.dJ,!0)}),2),i=n[0],c=(n[1],(0,a.useRouter)().query.userid),h=(0,l.useSession)(),y=h.data,I=h.status,g=(0,s.useState)(null==y||null===(e=y.user)||void 0===e?void 0:e.name),v=g[0],b=g[1],E=(0,u.useQuery)(["user".concat(c)],(t=r().mark((function e(){var t;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,d()("/api/user",{params:{id:c}});case 2:return t=e.sent,b(t.data.name),e.abrupt("return",t.data);case 5:case"end":return e.stop()}}),e)})),function(){var e=this,n=arguments;return new Promise((function(i,r){var o=t.apply(e,n);function s(e){m(o,i,r,s,l,"next",e)}function l(e){m(o,i,r,s,l,"throw",e)}s(void 0)}))})),x=E.isLoading,j=E.data;return"loading"===I||x?(0,o.jsx)("div",{className:"post splash",children:(0,o.jsx)("p",{children:"Loading..."})}):(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("div",{className:"post splash",children:(0,o.jsxs)("div",{className:"profile",children:[(0,o.jsxs)("span",{className:"userCard",children:[(0,o.jsx)("img",{className:"pfp",style:{margin:3,marginTop:6},src:null==j?void 0:j.image}),y&&y.userId===c?(0,o.jsxs)("span",{children:[(0,o.jsx)("input",{type:"text",placeholder:v,value:v,onChange:function(e){return b(e.target.value)}}),(0,o.jsx)("button",{className:"simulation-button",onClick:function(){fetch("/api/updateProfile/",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:v})}).then((function(e){return window.location.reload()}))},children:"Save Name"})]}):(0,o.jsx)("a",{children:(0,o.jsx)("b",{children:null==j?void 0:j.name})})]}),(0,o.jsxs)("div",{className:"profile-stats",style:{marginTop:"0px"},children:[j.trophiesReceived>0&&(0,o.jsxs)("div",{children:["🏆",j.trophiesReceived]}),j.starsReceived>0&&(0,o.jsxs)("div",{children:["⭐",j.starsReceived]})]}),(0,o.jsxs)("span",{children:[j.bannedAt?(0,o.jsx)("span",{style:{color:"red",marginRight:"1em"},children:"⚠ BANNED USER"}):"",y&&"admin"===y.role&&i.admin&&(0,o.jsx)(o.Fragment,{children:(0,o.jsxs)("button",{onClick:function(){fetch("/api/updateProfile/",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({banned:!j.bannedAt})}).then((function(e){return window.location.reload()}))},style:{marginBottom:6},children:[j.bannedAt?"forgive":"ban"," this sucker"]})})]}),y&&y.userId===c&&(0,o.jsx)("div",{style:{marginTop:"10px"},children:(0,o.jsx)("button",{onClick:l.signOut,style:{marginBottom:6},children:"Sign Out"})})]})}),(0,o.jsxs)("div",{className:"post splash",children:["User","'","s Creations"]})]})}},8531:function(e,t,n){n.r(t);var i=n(5893),r=n(9547),o=n.n(r),s=n(7294),l="▌▀▐▄";t.default=function(){var e=(0,s.useState)(0),t=e[0],n=e[1];return function(e,t){var n=(0,s.useRef)();(0,s.useEffect)((function(){n.current=e}),[e]),(0,s.useEffect)((function(){var e=setInterval((function(){n.current()}),100);return function(){return clearInterval(e)}}),[100])}((function(){n((t+1)%4)})),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("span",{className:"jsx-f08aeb1d1ef594cd",children:l[t]}),(0,i.jsx)(o(),{id:"f08aeb1d1ef594cd",children:"span.jsx-f08aeb1d1ef594cd{position:absolute;left:5px;top:5px}"})]})}}}]);